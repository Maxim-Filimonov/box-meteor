name: meteor
version: 0.1.8
inherits: wercker/ubuntu12.04-nodejs0.10@0.0.1
type: main
platform: ubuntu@12.04
description: box for building testing and deploying meteor apps
keywords:
  - meteor
  - opensource
  - javascript
  - nodejs
packages:
  - meteor@0.6.4
script: |
  sudo dpkg --get-selections | grep mongo
  sudo apt-get purge mongodb-clients
  sudo apt-key adv --keyserver keyserver.ubuntu.com --recv 7F0CEB10
  echo 'deb http://downloads-distro.mongodb.org/repo/ubuntu-upstart dist 10gen' | sudo tee /etc/apt/sources.list.d/10gen.list
  sudo apt-get update
  sudo apt-get install mongodb-10gen lsof
  sudo -s
  ls -la /etc/mongodb.conf
  echo 'nojournal = true' | sudo tee -a /etc/mongodb.conf
  echo 'verbose = true' | sudo tee -a /etc/mongodb.conf
  echo 'noprealloc = true' | sudo tee -a /etc/mongodb.conf
  echo 'smallfiles = true' | sudo tee -a /etc/mongodb.conf
  echo 'port = 38128' | sudo tee -a /etc/mongodb.conf
  cat /etc/mongodb.conf
  sudo /bin/sh install.sh
  sudo lsof -Pnl +M -i4
  ps aux
  cat /var/log/mongodb/mongodb.log
  sudo start mongodb
  sleep 5
  sudo lsof -Pnl +M -i4
  cat /var/log/mongodb/mongodb.log
  sleep 5
  cat /var/log/mongodb/mongodb.log
env:
  NODE_VERSION: "0.10.11"
  METEOR_VERSION: "0.6.4"
